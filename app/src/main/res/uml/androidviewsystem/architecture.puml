@startuml
title
<font color=red size=16>图形绘制总框架流程图</font>

endtitle

header
<font color=red>Warning:</font>
Do not use for commercial purposes.
endheader
'-----------------------------------------------------------
skinparam backgroundcolor Beige

participant App as A
participant Buffer
participant SurfaceFlinger as SF
participant EventThread as ET
participant DispSyncThread as DST

A o-[#ForestGreen]> ET : request VSync
DST --> ET : VSync
ET --> A : VSync
A -[#ForestGreen]> Buffer : draw
Buffer -[#ForestGreen]> SF : buffer ready
Buffer --[#ForestGreen]> A : finish
SF -[#ForestGreen]> ET : request VSync
A o-[#Fuchsia]> ET : request next VSync
DST --> ET : VSync
ET --> SF : VSync
SF -[#ForestGreen]>x Buffer : read Buffer\nand composite
ET --> A : VSync
A -[#Fuchsia]> Buffer : draw
Buffer -[#Fuchsia]> SF : buffer ready
Buffer --[#Fuchsia]> A : finish
SF -[#Fuchsia]> ET : request VSync
A o-[#Blue]> ET : request next VSync
DST --> ET : VSync
ET --> SF : VSync
SF -[#Fuchsia]>x Buffer : read Buffer\nand composite
ET --> A : VSync
A -[#Blue]> Buffer : draw
Buffer -[#Blue]> SF : buffer ready
Buffer --[#Blue]> A : finish
SF -[#Blue]> ET : request VSync
DST --> ET : VSync
ET --> SF : VSync
SF -[#Blue]>x Buffer : read Buffer\nand composite



'-----------------------------------------------------------
legend left
图示显示了3帧绘制过程，每一帧都是以o开始以x结束，三帧分别采用不同颜色
可以看出app和surfaceFlinger是两个不同的个体，分别独立请求和响应VSync
end legend
right footer Generated by Yaoguang
@enduml